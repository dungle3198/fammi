{"ast":null,"code":"var _jsxFileName = \"/Users/dungle/Desktop/fammi/src/components/Home.jsx\";\nimport React, { Component } from 'react';\nimport { createUser, data, user_list } from \"./Data/user\";\nimport { createFamily, joinFamily, family_list } from \"./Data/family\";\nimport { create_cometchat_user } from './Data/cometchatuser'; // import { ReactS3Client } from \"./Data/s3\";\n\nimport Navbar from \"./Navbar\";\nimport { Redirect } from 'react-router-dom';\nimport { v4 as uuidv4 } from 'uuid'; // For version 4\n\nimport $ from 'jquery';\n\nvar bcrypt = require(\"bcryptjs\");\n\nvar cookie = require(\"js-cookie\");\n\nexport default class Home extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      userlist: {},\n      email: \"\",\n      password: \"\",\n      key: \"\",\n      username: \"\",\n      avatar: \"\",\n      hasKey: false\n    };\n  }\n\n  checkUser() {\n    var email = cookie.get(\"email\"); //alert(email)\n\n    if (email !== undefined) {\n      return React.createElement(Redirect, {\n        to: \"/user\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 33\n        },\n        __self: this\n      });\n    }\n  }\n\n  handleFamilyKey(email) {\n    var fam = family_list.find(e => {\n      return e.family_key === this.state.key;\n    });\n\n    if (this.state.hasKey) {\n      if (fam !== undefined) {\n        fam.members.push(email);\n        joinFamily(this.state.key, fam.members);\n        this.setState({\n          email: \"\",\n          password: \"\",\n          key: \"\",\n          username: \"\",\n          avatar: \"\",\n          hasKey: false\n        });\n        data();\n        $('#signupModal').modal('hide');\n        return true;\n      }\n\n      alert(\"Invalid Family Key\");\n      return false;\n    } else {\n      if (fam === undefined) {\n        var members = [];\n        members.push(email);\n        createFamily(this.state.key, members);\n        return true;\n      }\n\n      alert(\"Existed Family Key\");\n      return false;\n    } //return false;\n    // if (fam === undefined) {\n    //     console.log(\"you created a family\");\n    //     var members = []\n    //     members.push(email);\n    //     createFamily(this.state.key, members)\n    //     return;\n    // } else {\n    //     console.log(\"you joined a family\");\n    //     fam.members.push(email)\n    //     joinFamily(this.state.key, fam.members);\n    //     return;\n    // }\n\n  }\n\n  keySelection(name) {\n    if (name === \"has\") {\n      console.log(\"you have a key already\");\n      this.setState({\n        hasKey: true\n      });\n    } else {\n      console.log(\"you dont have a key\");\n      this.setState({\n        hasKey: false\n      });\n    }\n  }\n\n  signUp(e) {\n    if (user_list.find(u => u.email === this.state.email) === undefined) {\n      function validateEmail(email) {\n        return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n      }\n\n      if (validateEmail(this.state.email) === true && this.handleFamilyKey()) {\n        var hashed = bcrypt.hashSync(this.state.password, 10); // hashing password\n\n        var commet_id = \"user\" + uuidv4();\n        createUser(this.state.email, hashed, this.state.key, this.state.username, \"\", commet_id); // then create it \n\n        create_cometchat_user(this.state.email, commet_id, \"https://unknown2020.s3-ap-southeast-1.amazonaws.com/ava.jpg\", this.state.key);\n        this.handleFamilyKey(this.state.email);\n        return React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        }); // if (document.getElementById(\"avatar\").files[0] === undefined) {\n        //     createUser(this.state.email, hashed, this.state.key, this.state.username, \"\", commet_id)// then create it \n        //     create_cometchat_user(this.state.email, commet_id, \"https://unknown2020.s3-ap-southeast-1.amazonaws.com/ava.jpg\", this.state.key)\n        //     this.handleFamilyKey(this.state.email)\n        //     return (<Redirect to={\"/\"} />)\n        // }\n        // var path = document.getElementById(\"avatar\").files[0].name; // get the image file name\n        // var filename = path.split('.')[0]; // get the name without the type\n        // ReactS3Client\n        //     .uploadFile(document.getElementById(\"avatar\").files[0], filename) // pload the image up to s3 first\n        //     .then(data => {\n        //         createUser(this.state.email, hashed, this.state.key, this.state.username, data.location, commet_id)// then create it \n        //         create_cometchat_user(this.state.email, commet_id, data.location, this.state.key)\n        //         this.handleFamilyKey(this.state.email)\n        //     })//create cometchat user\n        //     .then(alert(\"You have signed up successfully!\"))\n        //     .catch(err => console.error(err))\n        //createUser(this.state.email, hashed, this.state.key, this.state.username)\n        //setTimeout(e, 1000)\n        //alert(\"You have successfully signed up\")\n      }\n    } else if (user_list.find(u => u.email === this.state.email) !== undefined) {\n      alert(\"This email address has been used for another account\");\n      return;\n    }\n\n    alert(\"Invalid email address\");\n  }\n\n  login(e) {\n    if (user_list.find(u => u.email === this.state.email) !== undefined) {\n      var user = user_list.find(u => u.email === this.state.email);\n\n      if (bcrypt.compareSync(this.state.password, user.password)) {\n        var check_box = document.getElementById(\"exampleCheck1\");\n\n        if (check_box) {\n          if (check_box.checked) {\n            cookie.set(\"email\", user.email); //alert(cookie.get(\"email\"))\n\n            cookie.set(\"username\", user.username);\n          } else {\n            cookie.set(\"email\", user.email, {\n              expires: 1 / 24\n            }); //alert(cookie.get(\"email\"))\n\n            cookie.set(\"username\", user.username, {\n              expires: 1 / 24\n            });\n          }\n        }\n\n        this.props.loginFunction(user); //alert(\"You have logged in successfully.\")\n\n        return;\n      }\n    }\n\n    alert(\"Incorrect email or password\");\n  }\n\n  handleAvatar() {\n    if (this.state.avatar !== \"\") {\n      return this.state.avatar;\n    }\n\n    return require('./imgs/ava.jpg');\n  }\n\n  displayAvatar() {\n    return React.createElement(\"img\", {\n      src: this.handleAvatar(),\n      alt: \"\",\n      width: \"150px\",\n      height: \"150px\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    });\n  }\n\n  handleChange(e) {\n    let obj = {};\n    obj[e.target.name] = e.target.value;\n    this.setState(obj); //console.log(user_list)\n  }\n\n  componentDidMount() {\n    data();\n  }\n\n  render() {\n    return React.createElement(React.Fragment, null, this.checkUser(), React.createElement(\"div\", {\n      className: \"Home bg-transparent\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(Navbar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"Background bg-white m-0 p-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"Smaller w-100 row border m-0 rounded\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-3 bg-white p-4 d-flex align-items-center rounded-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"list-unstyled w-100\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      className: \"lead pl-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, \"Post Story\"), React.createElement(\"li\", {\n      className: \"lead mt-2 pl-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, \"Share Event\"), React.createElement(\"li\", {\n      className: \"lead mt-2 pl-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, \"Add to-do list\"), React.createElement(\"p\", {\n      className: \"text-center m-0\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195\n      },\n      __self: this\n    }, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-primary text-white mt-1\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#signupModal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, \"Sign up now\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-outline-primary mt-1\",\n      \"data-toggle\": \"modal\",\n      \"data-target\": \"#loginModal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199\n      },\n      __self: this\n    }, \"Or login.\")))), React.createElement(\"div\", {\n      className: \"col-9 p-0 rounded-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"Img rounded-right\",\n      src: require('./imgs/home.jpg'),\n      alt: \"\",\n      width: \"100%\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"modal fade\",\n      id: \"signupModal\",\n      tabIndex: -1,\n      role: \"dialog\",\n      \"aria-labelledby\": \"exampleModalLabel\",\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-dialog\",\n      role: \"document\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"modal-title lead\",\n      id: \"exampleModalLabel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214\n      },\n      __self: this\n    }, \"Signup\"), React.createElement(\"button\", {\n      type: \"button\",\n      className: \"close\",\n      \"data-dismiss\": \"modal\",\n      \"aria-label\": \"Close\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, \"\\xD7\"))), React.createElement(\"div\", {\n      className: \"modal-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"exampleInputEmail2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234\n      },\n      __self: this\n    }, \"Email address\"), React.createElement(\"input\", {\n      type: \"email\",\n      className: \"form-control\",\n      id: \"exampleInputEmail2\",\n      \"aria-describedby\": \"emailHelp\",\n      placeholder: \"Enter email\",\n      name: \"email\",\n      value: this.state.email,\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"exampleInputUsername3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, \"Username\"), React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control\",\n      id: \"exampleInputEmail3\",\n      placeholder: \"Enter username\",\n      name: \"username\",\n      value: this.state.username,\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"exampleInputPassword1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255\n      },\n      __self: this\n    }, \"Password\"), React.createElement(\"input\", {\n      type: \"password\",\n      className: \"form-control\",\n      id: \"exampleInputPassword1\",\n      placeholder: \"Password\",\n      name: \"password\",\n      value: this.state.password,\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"exampleInputPassword2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }, \"Comfirm Password\"), React.createElement(\"input\", {\n      type: \"password\",\n      className: \"form-control\",\n      id: \"exampleInputPassword2\",\n      placeholder: \"Password\",\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"exampleInputEmail1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, \"Key\"), React.createElement(\"select\", {\n      className: \"form-control\",\n      id: \"exampleFormControlSelect1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      onClick: this.keySelection.bind(this, \"not\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }, \"Generate new key\"), React.createElement(\"option\", {\n      onClick: this.keySelection.bind(this, \"has\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    }, \"Aldready have key\")), React.createElement(\"input\", {\n      type: \"text\",\n      className: \"form-control mt-2\",\n      id: \"exampleInputKey1\",\n      placeholder: \"Enter key\",\n      name: \"key\",\n      value: this.state.key,\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"w-100 text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-primary w-75\",\n      onClick: this.signUp.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, \"Signup\"))))))), React.createElement(\"div\", {\n      className: \"modal fade\",\n      id: \"loginModal\",\n      tabIndex: -1,\n      role: \"dialog\",\n      \"aria-labelledby\": \"exampleModalLabel\",\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-dialog\",\n      role: \"document\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"modal-title lead\",\n      id: \"exampleModalLabel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }, \"Login\"), React.createElement(\"button\", {\n      type: \"button\",\n      className: \"close\",\n      \"data-dismiss\": \"modal\",\n      \"aria-label\": \"Close\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      \"aria-hidden\": \"true\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, \"\\xD7\"))), React.createElement(\"div\", {\n      className: \"modal-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 308\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 311\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"exampleInputEmail1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, \"Email address\"), React.createElement(\"input\", {\n      type: \"email\",\n      className: \"form-control\",\n      id: \"exampleInputEmail1\",\n      \"aria-describedby\": \"emailHelp\",\n      placeholder: \"Enter email\",\n      name: \"email\",\n      value: this.state.email,\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"exampleInputPassword3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }, \"Password\"), React.createElement(\"input\", {\n      type: \"password\",\n      className: \"form-control\",\n      id: \"exampleInputPassword3\",\n      placeholder: \"Password\",\n      name: \"password\",\n      value: this.state.password,\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"form-check\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"checkbox\",\n      className: \"form-check-input\",\n      id: \"exampleCheck1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      className: \"form-check-label\",\n      htmlFor: \"exampleCheck1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 336\n      },\n      __self: this\n    }, \"Save password\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"w-100 text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"button\",\n      className: \"btn btn-primary w-75\",\n      onClick: this.login.bind(this),\n      \"data-dismiss\": \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341\n      },\n      __self: this\n    }, \"Continue\")))))))));\n  }\n\n}","map":{"version":3,"sources":["/Users/dungle/Desktop/fammi/src/components/Home.jsx"],"names":["React","Component","createUser","data","user_list","createFamily","joinFamily","family_list","create_cometchat_user","Navbar","Redirect","v4","uuidv4","$","bcrypt","require","cookie","Home","constructor","props","state","userlist","email","password","key","username","avatar","hasKey","checkUser","get","undefined","handleFamilyKey","fam","find","e","family_key","members","push","setState","modal","alert","keySelection","name","console","log","signUp","u","validateEmail","test","hashed","hashSync","commet_id","login","user","compareSync","check_box","document","getElementById","checked","set","expires","loginFunction","handleAvatar","displayAvatar","handleChange","obj","target","value","componentDidMount","render","bind"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,UAAT,EAAqBC,IAArB,EAA2BC,SAA3B,QAA4C,aAA5C;AACA,SAASC,YAAT,EAAuBC,UAAvB,EAAmCC,WAAnC,QAAsD,eAAtD;AACA,SAASC,qBAAT,QAAsC,sBAAtC,C,CACA;;AACA,OAAOC,MAAP,MAAmB,UAAnB;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,SAASC,EAAE,IAAIC,MAAf,QAA6B,MAA7B,C,CAAqC;;AACrC,OAAOC,CAAP,MAAc,QAAd;;AACA,IAAIC,MAAM,GAAGC,OAAO,CAAC,UAAD,CAApB;;AACA,IAAIC,MAAM,GAAGD,OAAO,CAAC,WAAD,CAApB;;AAEA,eAAe,MAAME,IAAN,SAAmBhB,SAAnB,CAA6B;AAExCiB,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AAETC,MAAAA,QAAQ,EAAE,EAFD;AAGTC,MAAAA,KAAK,EAAE,EAHE;AAITC,MAAAA,QAAQ,EAAE,EAJD;AAKTC,MAAAA,GAAG,EAAE,EALI;AAMTC,MAAAA,QAAQ,EAAE,EAND;AAOTC,MAAAA,MAAM,EAAE,EAPC;AAQTC,MAAAA,MAAM,EAAE;AARC,KAAb;AAWH;;AACDC,EAAAA,SAAS,GAAG;AACR,QAAIN,KAAK,GAAGN,MAAM,CAACa,GAAP,CAAW,OAAX,CAAZ,CADQ,CAER;;AACA,QAAIP,KAAK,KAAKQ,SAAd,EAAyB;AACrB,aAAO,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAC,OAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACH;AACJ;;AACDC,EAAAA,eAAe,CAACT,KAAD,EAAQ;AACnB,QAAIU,GAAG,GAAGzB,WAAW,CAAC0B,IAAZ,CAAkBC,CAAD,IAAO;AAAE,aAAOA,CAAC,CAACC,UAAF,KAAiB,KAAKf,KAAL,CAAWI,GAAnC;AAAwC,KAAlE,CAAV;;AACA,QAAI,KAAKJ,KAAL,CAAWO,MAAf,EAAuB;AACnB,UAAIK,GAAG,KAAKF,SAAZ,EAAuB;AACnBE,QAAAA,GAAG,CAACI,OAAJ,CAAYC,IAAZ,CAAiBf,KAAjB;AACAhB,QAAAA,UAAU,CAAC,KAAKc,KAAL,CAAWI,GAAZ,EAAiBQ,GAAG,CAACI,OAArB,CAAV;AACA,aAAKE,QAAL,CAAc;AACVhB,UAAAA,KAAK,EAAE,EADG;AAEVC,UAAAA,QAAQ,EAAE,EAFA;AAGVC,UAAAA,GAAG,EAAE,EAHK;AAIVC,UAAAA,QAAQ,EAAE,EAJA;AAKVC,UAAAA,MAAM,EAAE,EALE;AAMVC,UAAAA,MAAM,EAAE;AANE,SAAd;AAQAxB,QAAAA,IAAI;AACJU,QAAAA,CAAC,CAAC,cAAD,CAAD,CAAkB0B,KAAlB,CAAwB,MAAxB;AACA,eAAO,IAAP;AAEH;;AACDC,MAAAA,KAAK,CAAC,oBAAD,CAAL;AACA,aAAO,KAAP;AACH,KAnBD,MAoBK;AACD,UAAIR,GAAG,KAAKF,SAAZ,EAAuB;AACnB,YAAIM,OAAO,GAAG,EAAd;AACAA,QAAAA,OAAO,CAACC,IAAR,CAAaf,KAAb;AACAjB,QAAAA,YAAY,CAAC,KAAKe,KAAL,CAAWI,GAAZ,EAAiBY,OAAjB,CAAZ;AACA,eAAO,IAAP;AACH;;AACDI,MAAAA,KAAK,CAAC,oBAAD,CAAL;AACA,aAAO,KAAP;AACH,KA/BkB,CAgCnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACH;;AACDC,EAAAA,YAAY,CAACC,IAAD,EAAO;AACf,QAAIA,IAAI,KAAK,KAAb,EAAoB;AAChBC,MAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ;AACA,WAAKN,QAAL,CAAc;AAAEX,QAAAA,MAAM,EAAE;AAAV,OAAd;AACH,KAHD,MAIK;AACDgB,MAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;AACA,WAAKN,QAAL,CAAc;AAAEX,QAAAA,MAAM,EAAE;AAAV,OAAd;AACH;AACJ;;AACDkB,EAAAA,MAAM,CAACX,CAAD,EAAI;AACN,QAAI9B,SAAS,CAAC6B,IAAV,CAAea,CAAC,IAAIA,CAAC,CAACxB,KAAF,KAAY,KAAKF,KAAL,CAAWE,KAA3C,MAAsDQ,SAA1D,EAAqE;AACjE,eAASiB,aAAT,CAAuBzB,KAAvB,EAA8B;AAC1B,eAAO,6BAA6B0B,IAA7B,CAAkC1B,KAAlC,CAAP;AACH;;AACD,UAAIyB,aAAa,CAAC,KAAK3B,KAAL,CAAWE,KAAZ,CAAb,KAAoC,IAApC,IAA4C,KAAKS,eAAL,EAAhD,EAAwE;AACpE,YAAIkB,MAAM,GAAGnC,MAAM,CAACoC,QAAP,CAAgB,KAAK9B,KAAL,CAAWG,QAA3B,EAAqC,EAArC,CAAb,CADoE,CACd;;AACtD,YAAI4B,SAAS,GAAG,SAASvC,MAAM,EAA/B;AAEAV,QAAAA,UAAU,CAAC,KAAKkB,KAAL,CAAWE,KAAZ,EAAmB2B,MAAnB,EAA2B,KAAK7B,KAAL,CAAWI,GAAtC,EAA2C,KAAKJ,KAAL,CAAWK,QAAtD,EAAgE,EAAhE,EAAoE0B,SAApE,CAAV,CAJoE,CAIoB;;AACxF3C,QAAAA,qBAAqB,CAAC,KAAKY,KAAL,CAAWE,KAAZ,EAAmB6B,SAAnB,EAA8B,6DAA9B,EAA6F,KAAK/B,KAAL,CAAWI,GAAxG,CAArB;AACA,aAAKO,eAAL,CAAqB,KAAKX,KAAL,CAAWE,KAAhC;AACA,eAAQ,oBAAC,QAAD;AAAU,UAAA,EAAE,EAAE,GAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAR,CAPoE,CAQpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACH;AACJ,KApCD,MAqCK,IAAIlB,SAAS,CAAC6B,IAAV,CAAea,CAAC,IAAIA,CAAC,CAACxB,KAAF,KAAY,KAAKF,KAAL,CAAWE,KAA3C,MAAsDQ,SAA1D,EAAqE;AACtEU,MAAAA,KAAK,CAAC,sDAAD,CAAL;AACA;AACH;;AACDA,IAAAA,KAAK,CAAC,uBAAD,CAAL;AACH;;AACDY,EAAAA,KAAK,CAAClB,CAAD,EAAI;AACL,QAAI9B,SAAS,CAAC6B,IAAV,CAAea,CAAC,IAAIA,CAAC,CAACxB,KAAF,KAAY,KAAKF,KAAL,CAAWE,KAA3C,MAAsDQ,SAA1D,EAAqE;AACjE,UAAIuB,IAAI,GAAGjD,SAAS,CAAC6B,IAAV,CAAea,CAAC,IAAIA,CAAC,CAACxB,KAAF,KAAY,KAAKF,KAAL,CAAWE,KAA3C,CAAX;;AACA,UAAIR,MAAM,CAACwC,WAAP,CAAmB,KAAKlC,KAAL,CAAWG,QAA9B,EAAwC8B,IAAI,CAAC9B,QAA7C,CAAJ,EAA4D;AAExD,YAAIgC,SAAS,GAAGC,QAAQ,CAACC,cAAT,CAAwB,eAAxB,CAAhB;;AACA,YAAIF,SAAJ,EAAe;AACX,cAAIA,SAAS,CAACG,OAAd,EAAuB;AACnB1C,YAAAA,MAAM,CAAC2C,GAAP,CAAW,OAAX,EAAoBN,IAAI,CAAC/B,KAAzB,EADmB,CAEnB;;AACAN,YAAAA,MAAM,CAAC2C,GAAP,CAAW,UAAX,EAAuBN,IAAI,CAAC5B,QAA5B;AACH,WAJD,MAKK;AACDT,YAAAA,MAAM,CAAC2C,GAAP,CAAW,OAAX,EAAoBN,IAAI,CAAC/B,KAAzB,EAAgC;AAAEsC,cAAAA,OAAO,EAAE,IAAI;AAAf,aAAhC,EADC,CAED;;AACA5C,YAAAA,MAAM,CAAC2C,GAAP,CAAW,UAAX,EAAuBN,IAAI,CAAC5B,QAA5B,EAAsC;AAAEmC,cAAAA,OAAO,EAAE,IAAI;AAAf,aAAtC;AACH;AACJ;;AACD,aAAKzC,KAAL,CAAW0C,aAAX,CAAyBR,IAAzB,EAfwD,CAgBxD;;AACA;AACH;AACJ;;AACDb,IAAAA,KAAK,CAAC,6BAAD,CAAL;AACH;;AACDsB,EAAAA,YAAY,GAAG;AACX,QAAI,KAAK1C,KAAL,CAAWM,MAAX,KAAsB,EAA1B,EAA8B;AAC1B,aAAO,KAAKN,KAAL,CAAWM,MAAlB;AACH;;AACD,WAAOX,OAAO,CAAC,gBAAD,CAAd;AACH;;AACDgD,EAAAA,aAAa,GAAG;AACZ,WAAO;AAAK,MAAA,GAAG,EAAE,KAAKD,YAAL,EAAV;AAA+B,MAAA,GAAG,EAAC,EAAnC;AAAsC,MAAA,KAAK,EAAC,OAA5C;AAAoD,MAAA,MAAM,EAAC,OAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACH;;AACDE,EAAAA,YAAY,CAAC9B,CAAD,EAAI;AACZ,QAAI+B,GAAG,GAAG,EAAV;AACAA,IAAAA,GAAG,CAAC/B,CAAC,CAACgC,MAAF,CAASxB,IAAV,CAAH,GAAqBR,CAAC,CAACgC,MAAF,CAASC,KAA9B;AACA,SAAK7B,QAAL,CAAc2B,GAAd,EAHY,CAIZ;AACH;;AACDG,EAAAA,iBAAiB,GAAG;AAChBjE,IAAAA,IAAI;AACP;;AAEDkE,EAAAA,MAAM,GAAG;AACL,WACI,0CACK,KAAKzC,SAAL,EADL,EAEI;AAAK,MAAA,SAAS,EAAC,qBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAII;AAAK,MAAA,SAAS,EAAC,6BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,sCAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,2DAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAI,MAAA,SAAS,EAAC,qBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAI,MAAA,SAAS,EAAC,WAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,EAEI;AAAI,MAAA,SAAS,EAAC,gBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAFJ,EAGI;AAAI,MAAA,SAAS,EAAC,gBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHJ,EAII;AAAG,MAAA,SAAS,EAAC,iBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEI;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,SAAS,EAAC,iCAAhC;AAAkE,qBAAY,OAA9E;AAAsF,qBAAY,cAAlG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAFJ,EAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHJ,EAII;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,SAAS,EAAC,8BAAhC;AAA+D,qBAAY,OAA3E;AAAmF,qBAAY,aAA/F;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAJJ,CAJJ,CADJ,CADJ,EAeI;AAAK,MAAA,SAAS,EAAC,yBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAmC,MAAA,GAAG,EAAEb,OAAO,CAAC,iBAAD,CAA/C;AAAoE,MAAA,GAAG,EAAC,EAAxE;AAA2E,MAAA,KAAK,EAAC,MAAjF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CAfJ,CADJ,CAJJ,EA0BI;AAAK,MAAA,SAAS,EAAC,YAAf;AAA4B,MAAA,EAAE,EAAC,aAA/B;AAA6C,MAAA,QAAQ,EAAE,CAAC,CAAxD;AAA2D,MAAA,IAAI,EAAC,QAAhE;AAAyE,yBAAgB,mBAAzF;AAA6G,qBAAY,MAAzH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,cAAf;AAA8B,MAAA,IAAI,EAAC,UAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAG,MAAA,SAAS,EAAC,kBAAb;AAAgC,MAAA,EAAE,EAAC,mBAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,EAEI;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,SAAS,EAAC,OAAhC;AAAwC,sBAAa,OAArD;AAA6D,oBAAW,OAAxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAM,qBAAY,MAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,CAFJ,CADJ,EAOI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAYI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,OAAO,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADJ,EAEI;AAAO,MAAA,IAAI,EAAC,OAAZ;AACI,MAAA,SAAS,EAAC,cADd;AAEI,MAAA,EAAE,EAAC,oBAFP;AAGI,0BAAiB,WAHrB;AAII,MAAA,WAAW,EAAC,aAJhB;AAKI,MAAA,IAAI,EAAC,OALT;AAMI,MAAA,KAAK,EAAE,KAAKK,KAAL,CAAWE,KANtB;AAOI,MAAA,QAAQ,EAAE,KAAK0C,YAAL,CAAkBM,IAAlB,CAAuB,IAAvB,CAPd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CAZJ,EAuBI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,OAAO,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,EAEI;AAAO,MAAA,IAAI,EAAC,MAAZ;AACI,MAAA,SAAS,EAAC,cADd;AAEI,MAAA,EAAE,EAAC,oBAFP;AAGI,MAAA,WAAW,EAAC,gBAHhB;AAII,MAAA,IAAI,EAAC,UAJT;AAKI,MAAA,KAAK,EAAE,KAAKlD,KAAL,CAAWK,QALtB;AAMI,MAAA,QAAQ,EAAE,KAAKuC,YAAL,CAAkBM,IAAlB,CAAuB,IAAvB,CANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CAvBJ,EAiCI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,OAAO,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,EAEI;AAAO,MAAA,IAAI,EAAC,UAAZ;AACI,MAAA,SAAS,EAAC,cADd;AAEI,MAAA,EAAE,EAAC,uBAFP;AAGI,MAAA,WAAW,EAAC,UAHhB;AAII,MAAA,IAAI,EAAC,UAJT;AAKI,MAAA,KAAK,EAAE,KAAKlD,KAAL,CAAWG,QALtB;AAMI,MAAA,QAAQ,EAAE,KAAKyC,YAAL,CAAkBM,IAAlB,CAAuB,IAAvB,CANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CAjCJ,EA2CI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,OAAO,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADJ,EAEI;AAAO,MAAA,IAAI,EAAC,UAAZ;AACI,MAAA,SAAS,EAAC,cADd;AAEI,MAAA,EAAE,EAAC,uBAFP;AAGI,MAAA,WAAW,EAAC,UAHhB;AAII,MAAA,QAAQ,EAAE,KAAKN,YAAL,CAAkBM,IAAlB,CAAuB,IAAvB,CAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CA3CJ,EAmDI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,OAAO,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADJ,EAEI;AAAQ,MAAA,SAAS,EAAC,cAAlB;AAAiC,MAAA,EAAE,EAAC,2BAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAQ,MAAA,OAAO,EAAE,KAAK7B,YAAL,CAAkB6B,IAAlB,CAAuB,IAAvB,EAA6B,KAA7B,CAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADJ,EAEI;AAAQ,MAAA,OAAO,EAAE,KAAK7B,YAAL,CAAkB6B,IAAlB,CAAuB,IAAvB,EAA6B,KAA7B,CAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAFJ,CAFJ,EAMI;AAAO,MAAA,IAAI,EAAC,MAAZ;AACI,MAAA,SAAS,EAAC,mBADd;AAEI,MAAA,EAAE,EAAC,kBAFP;AAGI,MAAA,WAAW,EAAC,WAHhB;AAII,MAAA,IAAI,EAAC,KAJT;AAKI,MAAA,KAAK,EAAE,KAAKlD,KAAL,CAAWI,GALtB;AAMI,MAAA,QAAQ,EAAE,KAAKwC,YAAL,CAAkBM,IAAlB,CAAuB,IAAvB,CANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANJ,CAnDJ,EAiEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAjEJ,EAkEI;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AACI,MAAA,IAAI,EAAC,QADT;AAEI,MAAA,SAAS,EAAC,sBAFd;AAGI,MAAA,OAAO,EAAE,KAAKzB,MAAL,CAAYyB,IAAZ,CAAiB,IAAjB,CAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,CAlEJ,CAFJ,CAPJ,CADJ,CADJ,CA1BJ,EAmHI;AAAK,MAAA,SAAS,EAAC,YAAf;AAA4B,MAAA,EAAE,EAAC,YAA/B;AAA4C,MAAA,QAAQ,EAAE,CAAC,CAAvD;AAA0D,MAAA,IAAI,EAAC,QAA/D;AAAwE,yBAAgB,mBAAxF;AAA4G,qBAAY,MAAxH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,cAAf;AAA8B,MAAA,IAAI,EAAC,UAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAG,MAAA,SAAS,EAAC,kBAAb;AAAgC,MAAA,EAAE,EAAC,mBAAnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADJ,EAEI;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,SAAS,EAAC,OAAhC;AAAwC,sBAAa,OAArD;AAA6D,oBAAW,OAAxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAM,qBAAY,MAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,CAFJ,CADJ,EAOI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,OAAO,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADJ,EAEI;AAAO,MAAA,IAAI,EAAC,OAAZ;AACI,MAAA,SAAS,EAAC,cADd;AAEI,MAAA,EAAE,EAAC,oBAFP;AAGI,0BAAiB,WAHrB;AAII,MAAA,WAAW,EAAC,aAJhB;AAKI,MAAA,IAAI,EAAC,OALT;AAMI,MAAA,KAAK,EAAE,KAAKlD,KAAL,CAAWE,KANtB;AAOI,MAAA,QAAQ,EAAE,KAAK0C,YAAL,CAAkBM,IAAlB,CAAuB,IAAvB,CAPd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CADJ,EAYI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,OAAO,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADJ,EAEI;AAAO,MAAA,IAAI,EAAC,UAAZ;AACI,MAAA,SAAS,EAAC,cADd;AAEI,MAAA,EAAE,EAAC,uBAFP;AAGI,MAAA,WAAW,EAAC,UAHhB;AAII,MAAA,IAAI,EAAC,UAJT;AAKI,MAAA,KAAK,EAAE,KAAKlD,KAAL,CAAWG,QALtB;AAMI,MAAA,QAAQ,EAAE,KAAKyC,YAAL,CAAkBM,IAAlB,CAAuB,IAAvB,CANd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CAZJ,EAsBI;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAO,MAAA,IAAI,EAAC,UAAZ;AACI,MAAA,SAAS,EAAC,kBADd;AAEI,MAAA,EAAE,EAAC,eAFP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAII;AAAO,MAAA,SAAS,EAAC,kBAAjB;AAAoC,MAAA,OAAO,EAAC,eAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAJJ,CAtBJ,EA4BI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA5BJ,EA6BI;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEI;AACI,MAAA,IAAI,EAAC,QADT;AAEI,MAAA,SAAS,EAAC,sBAFd;AAGI,MAAA,OAAO,EAAE,KAAKlB,KAAL,CAAWkB,IAAX,CAAgB,IAAhB,CAHb;AAII,sBAAa,OAJjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,CA7BJ,CAFJ,CAPJ,CADJ,CADJ,CAnHJ,CAFJ,CADJ;AA+KH;;AAvVuC","sourcesContent":["import React, { Component } from 'react'\nimport { createUser, data, user_list } from \"./Data/user\";\nimport { createFamily, joinFamily, family_list } from \"./Data/family\";\nimport { create_cometchat_user } from './Data/cometchatuser'\n// import { ReactS3Client } from \"./Data/s3\";\nimport Navbar from \"./Navbar\";\nimport { Redirect } from 'react-router-dom';\nimport { v4 as uuidv4 } from 'uuid'; // For version 4\nimport $ from 'jquery';\nvar bcrypt = require(\"bcryptjs\");\nvar cookie = require(\"js-cookie\");\n\nexport default class Home extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n\n            userlist: {},\n            email: \"\",\n            password: \"\",\n            key: \"\",\n            username: \"\",\n            avatar: \"\",\n            hasKey: false\n        }\n\n    }\n    checkUser() {\n        var email = cookie.get(\"email\");\n        //alert(email)\n        if (email !== undefined) {\n            return <Redirect to=\"/user\" />\n        }\n    }\n    handleFamilyKey(email) {\n        var fam = family_list.find((e) => { return e.family_key === this.state.key });\n        if (this.state.hasKey) {\n            if (fam !== undefined) {\n                fam.members.push(email)\n                joinFamily(this.state.key, fam.members);\n                this.setState({\n                    email: \"\",\n                    password: \"\",\n                    key: \"\",\n                    username: \"\",\n                    avatar: \"\",\n                    hasKey: false\n                })\n                data()\n                $('#signupModal').modal('hide')\n                return true;\n\n            }\n            alert(\"Invalid Family Key\");\n            return false\n        }\n        else {\n            if (fam === undefined) {\n                var members = []\n                members.push(email);\n                createFamily(this.state.key, members)\n                return true;\n            }\n            alert(\"Existed Family Key\");\n            return false\n        }\n        //return false;\n        // if (fam === undefined) {\n        //     console.log(\"you created a family\");\n        //     var members = []\n        //     members.push(email);\n        //     createFamily(this.state.key, members)\n        //     return;\n        // } else {\n        //     console.log(\"you joined a family\");\n        //     fam.members.push(email)\n        //     joinFamily(this.state.key, fam.members);\n        //     return;\n        // }\n    }\n    keySelection(name) {\n        if (name === \"has\") {\n            console.log(\"you have a key already\");\n            this.setState({ hasKey: true })\n        }\n        else {\n            console.log(\"you dont have a key\");\n            this.setState({ hasKey: false })\n        }\n    }\n    signUp(e) {\n        if (user_list.find(u => u.email === this.state.email) === undefined) {\n            function validateEmail(email) {\n                return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)\n            }\n            if (validateEmail(this.state.email) === true && this.handleFamilyKey()) {\n                var hashed = bcrypt.hashSync(this.state.password, 10) // hashing password\n                var commet_id = \"user\" + uuidv4();\n\n                createUser(this.state.email, hashed, this.state.key, this.state.username, \"\", commet_id)// then create it \n                create_cometchat_user(this.state.email, commet_id, \"https://unknown2020.s3-ap-southeast-1.amazonaws.com/ava.jpg\", this.state.key)\n                this.handleFamilyKey(this.state.email)\n                return (<Redirect to={\"/\"} />)\n                // if (document.getElementById(\"avatar\").files[0] === undefined) {\n                //     createUser(this.state.email, hashed, this.state.key, this.state.username, \"\", commet_id)// then create it \n                //     create_cometchat_user(this.state.email, commet_id, \"https://unknown2020.s3-ap-southeast-1.amazonaws.com/ava.jpg\", this.state.key)\n                //     this.handleFamilyKey(this.state.email)\n                //     return (<Redirect to={\"/\"} />)\n                // }\n                // var path = document.getElementById(\"avatar\").files[0].name; // get the image file name\n                // var filename = path.split('.')[0]; // get the name without the type\n\n                // ReactS3Client\n                //     .uploadFile(document.getElementById(\"avatar\").files[0], filename) // pload the image up to s3 first\n                //     .then(data => {\n                //         createUser(this.state.email, hashed, this.state.key, this.state.username, data.location, commet_id)// then create it \n                //         create_cometchat_user(this.state.email, commet_id, data.location, this.state.key)\n                //         this.handleFamilyKey(this.state.email)\n                //     })//create cometchat user\n                //     .then(alert(\"You have signed up successfully!\"))\n                //     .catch(err => console.error(err))\n\n\n                //createUser(this.state.email, hashed, this.state.key, this.state.username)\n                //setTimeout(e, 1000)\n                //alert(\"You have successfully signed up\")\n            }\n        }\n        else if (user_list.find(u => u.email === this.state.email) !== undefined) {\n            alert(\"This email address has been used for another account\")\n            return\n        }\n        alert(\"Invalid email address\")\n    }\n    login(e) {\n        if (user_list.find(u => u.email === this.state.email) !== undefined) {\n            var user = user_list.find(u => u.email === this.state.email)\n            if (bcrypt.compareSync(this.state.password, user.password)) {\n\n                var check_box = document.getElementById(\"exampleCheck1\")\n                if (check_box) {\n                    if (check_box.checked) {\n                        cookie.set(\"email\", user.email)\n                        //alert(cookie.get(\"email\"))\n                        cookie.set(\"username\", user.username)\n                    }\n                    else {\n                        cookie.set(\"email\", user.email, { expires: 1 / 24 })\n                        //alert(cookie.get(\"email\"))\n                        cookie.set(\"username\", user.username, { expires: 1 / 24 })\n                    }\n                }\n                this.props.loginFunction(user);\n                //alert(\"You have logged in successfully.\")\n                return\n            }\n        }\n        alert(\"Incorrect email or password\")\n    }\n    handleAvatar() {\n        if (this.state.avatar !== \"\") {\n            return this.state.avatar;\n        }\n        return require('./imgs/ava.jpg');\n    }\n    displayAvatar() {\n        return <img src={this.handleAvatar()} alt=\"\" width=\"150px\" height=\"150px\" />\n    }\n    handleChange(e) {\n        let obj = {};\n        obj[e.target.name] = e.target.value;\n        this.setState(obj);\n        //console.log(user_list)\n    }\n    componentDidMount() {\n        data();\n    }\n\n    render() {\n        return (\n            <>\n                {this.checkUser()}\n                <div className=\"Home bg-transparent\">\n                    <Navbar />\n\n                    {/* Jumbotron */}\n                    <div className=\"Background bg-white m-0 p-4\">\n                        <div className=\"Smaller w-100 row border m-0 rounded\">\n                            <div className=\"col-3 bg-white p-4 d-flex align-items-center rounded-left\">\n                                <ul className=\"list-unstyled w-100\">\n                                    <li className=\"lead pl-3\">Post Story</li>\n                                    <li className=\"lead mt-2 pl-3\">Share Event</li>\n                                    <li className=\"lead mt-2 pl-3\">Add to-do list</li>\n                                    <p className=\"text-center m-0\">\n                                        <br />\n                                        <button type=\"button\" className=\"btn btn-primary text-white mt-1\" data-toggle=\"modal\" data-target=\"#signupModal\">Sign up now</button>\n                                        <br />\n                                        <button type=\"button\" className=\"btn btn-outline-primary mt-1\" data-toggle=\"modal\" data-target=\"#loginModal\">Or login.</button>\n                                    </p>\n\n                                </ul>\n                            </div>\n                            <div className=\"col-9 p-0 rounded-right\">\n                                <img className=\"Img rounded-right\" src={require('./imgs/home.jpg')} alt=\"\" width=\"100%\" />\n                            </div>\n                        </div>\n                    </div>\n                    {/* Signup */}\n                    <div className=\"modal fade\" id=\"signupModal\" tabIndex={-1} role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                        <div className=\"modal-dialog\" role=\"document\">\n                            <div className=\"modal-content\">\n                                <div className=\"modal-header\">\n                                    <p className=\"modal-title lead\" id=\"exampleModalLabel\">Signup</p>\n                                    <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                        <span aria-hidden=\"true\">×</span>\n                                    </button>\n                                </div>\n                                <div className=\"modal-body\">\n                                    {/* Form */}\n                                    <form>\n                                        {/* <div className=\"form-group\">\n                                            <label htmlFor=\"name\">Avatar: </label>\n                                            <div>{this.displayAvatar()}</div>\n                                            <input type=\"file\"\n                                                className=\"form-control\"\n                                                id=\"avatar\"\n                                                name=\"avatar\"\n                                                value={this.state.avatar}\n                                                onChange={this.handleChange.bind(this)}\n                                            />\n                                        </div> */}\n                                        <div className=\"form-group\">\n                                            <label htmlFor=\"exampleInputEmail2\">Email address</label>\n                                            <input type=\"email\"\n                                                className=\"form-control\"\n                                                id=\"exampleInputEmail2\"\n                                                aria-describedby=\"emailHelp\"\n                                                placeholder=\"Enter email\"\n                                                name=\"email\"\n                                                value={this.state.email}\n                                                onChange={this.handleChange.bind(this)} />\n                                        </div>\n                                        <div className=\"form-group\">\n                                            <label htmlFor=\"exampleInputUsername3\">Username</label>\n                                            <input type=\"text\"\n                                                className=\"form-control\"\n                                                id=\"exampleInputEmail3\"\n                                                placeholder=\"Enter username\"\n                                                name=\"username\"\n                                                value={this.state.username}\n                                                onChange={this.handleChange.bind(this)} />\n                                        </div>\n                                        <div className=\"form-group\">\n                                            <label htmlFor=\"exampleInputPassword1\">Password</label>\n                                            <input type=\"password\"\n                                                className=\"form-control\"\n                                                id=\"exampleInputPassword1\"\n                                                placeholder=\"Password\"\n                                                name=\"password\"\n                                                value={this.state.password}\n                                                onChange={this.handleChange.bind(this)} />\n                                        </div>\n                                        <div className=\"form-group\">\n                                            <label htmlFor=\"exampleInputPassword2\">Comfirm Password</label>\n                                            <input type=\"password\"\n                                                className=\"form-control\"\n                                                id=\"exampleInputPassword2\"\n                                                placeholder=\"Password\"\n                                                onChange={this.handleChange.bind(this)} />\n                                        </div>\n                                        <div className=\"form-group\">\n                                            <label htmlFor=\"exampleInputEmail1\">Key</label>\n                                            <select className=\"form-control\" id=\"exampleFormControlSelect1\">\n                                                <option onClick={this.keySelection.bind(this, \"not\")}>Generate new key</option>\n                                                <option onClick={this.keySelection.bind(this, \"has\")}>Aldready have key</option>\n                                            </select>\n                                            <input type=\"text\"\n                                                className=\"form-control mt-2\"\n                                                id=\"exampleInputKey1\"\n                                                placeholder=\"Enter key\"\n                                                name=\"key\"\n                                                value={this.state.key}\n                                                onChange={this.handleChange.bind(this)} />\n                                        </div>\n                                        <br />\n                                        <div className=\"w-100 text-center\">\n                                            <button\n                                                type=\"button\"\n                                                className=\"btn btn-primary w-75\"\n                                                onClick={this.signUp.bind(this)}>Signup</button>\n                                        </div>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    {/* Login */}\n                    <div className=\"modal fade\" id=\"loginModal\" tabIndex={-1} role=\"dialog\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                        <div className=\"modal-dialog\" role=\"document\">\n                            <div className=\"modal-content\">\n                                <div className=\"modal-header\">\n                                    <p className=\"modal-title lead\" id=\"exampleModalLabel\">Login</p>\n                                    <button type=\"button\" className=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                        <span aria-hidden=\"true\">×</span>\n                                    </button>\n                                </div>\n                                <div className=\"modal-body\">\n                                    {/* Form */}\n                                    <form>\n                                        <div className=\"form-group\">\n                                            <label htmlFor=\"exampleInputEmail1\">Email address</label>\n                                            <input type=\"email\"\n                                                className=\"form-control\"\n                                                id=\"exampleInputEmail1\"\n                                                aria-describedby=\"emailHelp\"\n                                                placeholder=\"Enter email\"\n                                                name=\"email\"\n                                                value={this.state.email}\n                                                onChange={this.handleChange.bind(this)} />\n                                        </div>\n                                        <div className=\"form-group\">\n                                            <label htmlFor=\"exampleInputPassword3\">Password</label>\n                                            <input type=\"password\"\n                                                className=\"form-control\"\n                                                id=\"exampleInputPassword3\"\n                                                placeholder=\"Password\"\n                                                name=\"password\"\n                                                value={this.state.password}\n                                                onChange={this.handleChange.bind(this)} />\n                                        </div>\n                                        <div className=\"form-check\">\n                                            <input type=\"checkbox\"\n                                                className=\"form-check-input\"\n                                                id=\"exampleCheck1\" />\n                                            <label className=\"form-check-label\" htmlFor=\"exampleCheck1\">Save password</label>\n                                        </div>\n                                        <br />\n                                        <div className=\"w-100 text-center\">\n\n                                            <button\n                                                type=\"button\"\n                                                className=\"btn btn-primary w-75\"\n                                                onClick={this.login.bind(this)}\n                                                data-dismiss=\"modal\">Continue</button>\n                                        </div>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </>\n\n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}